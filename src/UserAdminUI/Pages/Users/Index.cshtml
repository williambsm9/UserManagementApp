@page
@model UserAdminUI.Pages.Users.IndexModel

<h2>Users</h2>

<div class="mb-3">
    <form method="post" asp-page-handler="TotalCount" class="d-inline">
        <button class="btn btn-outline-primary">
            Total Users
        </button>
    </form>

    <form method="post" asp-page-handler="CountPerGroup" class="d-inline ms-2">
        <button class="btn btn-outline-secondary">
            Users per Group
        </button>
    </form>
</div>

@if (Model.TotalUserCount.HasValue)
{
    <div class="alert alert-info">
        <strong>Total Users:</strong> @Model.TotalUserCount
    </div>
}

@if (Model.UsersPerGroup.Any())
{
    <div class="alert alert-secondary">
        <strong>Users per Group:</strong>
        <ul class="mb-0">
        @foreach (var item in Model.UsersPerGroup)
        {
            <li>@item.Key: @item.Value</li>
        }
        </ul>
    </div>
}

<table class="table table-striped">
    <thead>
        <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Groups</th>
            <th style="width:180px;"></th>
        </tr>
    </thead>
    <tbody>
@foreach (var user in Model.Users)
{
        <tr>
            <td>@user.Name</td>
            <td>@user.Email</td>
            <td>@string.Join(", ", user.Groups.Select(g => g.Name))</td>
            <td>
                <a asp-page="Edit"
                   asp-route-id="@user.Id"
                   class="btn btn-sm btn-primary">
                    Edit
                </a>

                <form method="post"
                      asp-page-handler="Delete"
                      asp-route-id="@user.Id"
                      class="d-inline"
                      onsubmit="return confirm('Are you sure you want to delete this user?');">
                    <button type="submit" class="btn btn-sm btn-danger">
                        Delete
                    </button>
                </form>
            </td>
        </tr>
}
    </tbody>
</table>

<a asp-page="Create" class="btn btn-success">
    Create User
</a>